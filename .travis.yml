language: node_js
node_js: 6
dist: xenial
cache:
  npm: true
branches:
  only:
  - master
  - /^v\d+\.\d+\.\d+/

env:
  global:
  - DEBUG: electron-installer-flatpak,flatpak-bundler

before_install:
- sudo add-apt-repository -y ppa:alexlarsson/flatpak
- sudo apt update
- sudo apt install --no-install-recommends -y flatpak-builder
- flatpak install --user --no-deps --assumeyes --arch x86_64 --from https://raw.githubusercontent.com/endlessm/flatpak-bundler/master/refs/freedesktop-sdk-1.4.flatpakref
- flatpak install --user --no-deps --assumeyes --arch x86_64 --from https://raw.githubusercontent.com/endlessm/flatpak-bundler/master/refs/freedesktop-runtime-1.4.flatpakref
- flatpak install --user --no-deps --assumeyes --arch x86_64 --from https://s3-us-west-2.amazonaws.com/electron-flatpak.endlessm.com/electron-base-app-master.flatpakref

install:
- npm install
- npm update
